# -   name: Assert on 'git.dest'
#     assert:
#         that: (git.dest is defined and git.dest is not none and git.dest | trim != '')
#     tags:
#     - deploy
#     - bundler
#     - bundler_assert
-   name: Run Bundler
    bundler:
        state: present
        chdir: '{{ git.dest }}'
        clean: '{{ bundler.clean|default(''yes'') }}'
        gem_path: '{{ bundler.gem_path|default(omit) }}'
        extra_args: '{{ bundler.extra_args|default(omit) }}'
        binstub_directory: '{{ bundler.binstub_directory|default(omit) }}'
        exclude_groups: '{{ bundler.exclude_groups|default([''test'',''integration'',''development'',''openstack'',''tools'']) }}'
    become: '{{ bundler.with_sudo|default(omit) }}'
    tags:
    - deploy
    - bundler
    - bundler_install'
-   name: Adjust permissions of binstubs
    file:
        path: '{{ git.dest }}/bin'
        recurse: true
        owner: root
        group: root
        mode: 0755
        state: directory
    when: bundler.binstub_directory is defined
    become: true
    tags:
    - deploy
    - chef
    - bundler_permission_binstubs
